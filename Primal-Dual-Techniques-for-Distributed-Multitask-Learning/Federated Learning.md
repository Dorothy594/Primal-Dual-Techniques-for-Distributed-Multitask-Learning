# Federated Learning
Below is the reproduced result of _Netwrked Federated Multi-Task Learning_.
## SBM_experiment_two_cluster
```
algorithm 1, norm1: 
 mean train MSE: 6.4698986596733505e-06 
 mean test MSE: 6.627195715031921e-06
algorithm 1, norm2: 
 mean train MSE: 7.038874723248306e-06 
 mean test MSE: 7.919822768537505e-06
algorithm 1, mocha: 
 mean train MSE: 0.0008504003309019318 
 mean test MSE: 0.06394019780668332
federated learning: 
 mean train MSE: 4.051725271824381 
 mean test MSE: 4.147543289786365
linear regression: 
 mean train MSE: 3.9022515672722258 
 mean test MSE: 4.226502743254196
decision tree: 
 mean train MSE: 4.122261561839011 
 mean test MSE: 4.545924834146329
```
![two clusters error bars plot](https://github.com/Dorothy594/Primal-Dual-Techniques-for-Distributed-Multitask-Learning/blob/main/FederatedLearning/self%20try%20result/two%20cluster%20result/two%20cluster%20bar.png)
### norm1
```
penalty_func: norm1
M: 0.2
 MSEs_mean: {0.01: 2.958735522492587e-05, 0.05: 0.1194559530739967, 0.1: 3.3937054454975986, 0.15: 3.308141618820251, 0.2: 3.555617786180845, 0.25: 3.2767989484038993, 0.3: 3.598635441417933, 0.4: 3.37988864927199, 0.5: 3.5389892505964573, 0.6: 3.627264934284922}
 MSEs_std: {0.01: 4.337632077887632e-06, 0.05: 0.0343589638762547, 0.1: 0.08566246618443814, 0.15: 0.3402227098356647, 0.2: 0.39411340510453535, 0.25: 0.24273426917365895, 0.3: 0.38636943643726807, 0.4: 0.2381354366301481, 0.5: 0.4903985432731925, 0.6: 0.29077581663983576}
M: 0.4
 MSEs_mean: {0.01: 7.102524530291397e-06, 0.05: 0.000154078114462334, 0.1: 0.0006207997842140078, 0.15: 0.22436132950887258, 0.2: 2.6257931109285133, 0.25: 2.6608832457673244, 0.3: 2.8821932594588686, 0.4: 2.581380948726264, 0.5: 2.8279142157288053, 0.6: 2.7948618652054185}
 MSEs_std: {0.01: 1.495559104508231e-06, 0.05: 2.6230957595684935e-05, 0.1: 6.688544884945041e-05, 0.15: 0.059531367999503135, 0.2: 0.20308100152584668, 0.25: 0.27962519652831413, 0.3: 0.39616429645865153, 0.4: 0.23450963654625356, 0.5: 0.3976302276334751, 0.6: 0.36767645028419305}
M: 0.6
 MSEs_mean: {0.01: 3.044217359193656e-06, 0.05: 6.6720254646686e-05, 0.1: 0.00026753102607954455, 0.15: 0.0005690519075226593, 0.2: 0.00989659570175035, 0.25: 0.2520299174797652, 0.3: 1.4993752185425029, 0.4: 1.7753265001937184, 0.5: 1.8706502546177852, 0.6: 1.7041332587935962}
 MSEs_std: {0.01: 2.453216918172619e-07, 0.05: 4.557554017907675e-06, 0.1: 3.4889766772876215e-05, 0.15: 5.2499714895014274e-05, 0.2: 0.017435092636572558, 0.25: 0.11348288563332372, 0.3: 0.1852851268333664, 0.4: 0.15345188625520367, 0.5: 0.32720739577450064, 0.6: 0.1742130438186501}
```
![norm1 result](https://github.com/Dorothy594/Primal-Dual-Techniques-for-Distributed-Multitask-Learning/blob/main/FederatedLearning/self%20try%20result/two%20cluster%20result/norm1.png)

### norm2
```
penalty_func: norm2
M: 0.2
 MSEs_mean: {0.01: 0.004397002675228709, 0.05: 0.5168969219216782, 0.1: 3.3200613438055186, 0.15: 3.4852525758498887, 0.2: 3.7210974866846476, 0.25: 3.5604454159073327, 0.3: 3.349616631743241, 0.4: 3.497574697090873, 0.5: 3.6820840904236602, 0.6: 3.2467471391516547}
 MSEs_std: {0.01: 0.007916672856507928, 0.05: 0.11902013217236021, 0.1: 0.18410738251207664, 0.15: 0.4096926025088516, 0.2: 0.35238819063949506, 0.25: 0.20843900278595387, 0.3: 0.27041499825114457, 0.4: 0.27563587261494854, 0.5: 0.44768209755966015, 0.6: 0.11078097366486245}
M: 0.4
 MSEs_mean: {0.01: 7.871289175014592e-06, 0.05: 0.00015270425294931867, 0.1: 0.0006858952633718123, 0.15: 0.5184200952526524, 0.2: 2.430169622881921, 0.25: 2.8924524985698072, 0.3: 2.459750956460886, 0.4: 2.6121139524006667, 0.5: 2.520642087878345, 0.6: 2.9000059250618575}
 MSEs_std: {0.01: 1.0828972898096198e-06, 0.05: 2.4991769685474056e-05, 0.1: 0.00013583916957266059, 0.15: 0.09285926707626782, 0.2: 0.21739897597560498, 0.25: 0.40106903687504913, 0.3: 0.0688390000324632, 0.4: 0.26514896451090875, 0.5: 0.2606485281916742, 0.6: 0.4728792676405088}
M: 0.6
 MSEs_mean: {0.01: 3.4549787147910115e-06, 0.05: 6.272704704907836e-05, 0.1: 0.00027097554099744255, 0.15: 0.0006009450500747615, 0.2: 0.019007082980222502, 0.25: 0.3777763990022362, 0.3: 1.887893241007371, 0.4: 1.7908869936450311, 0.5: 1.7451567045993717, 0.6: 2.2265853451388056}
 MSEs_std: {0.01: 5.704588412211964e-07, 0.05: 2.1747230614864813e-06, 0.1: 2.1304184874430294e-05, 0.15: 0.00010216176939508432, 0.2: 0.025285218832188355, 0.25: 0.13058632013664465, 0.3: 0.4906954211298918, 0.4: 0.2700163500694947, 0.5: 0.18834266275032138, 0.6: 0.3735363884156735}
```
![norm2 result](https://github.com/Dorothy594/Primal-Dual-Techniques-for-Distributed-Multitask-Learning/blob/main/FederatedLearning/self%20try%20result/two%20cluster%20result/norm2.png)

### mocha
```
penalty_func: mocha
M: 0.2
 MSEs_mean: {0.01: 0.3338722627725496, 0.05: 1.140683381254258, 0.1: 2.0379861117427724, 0.15: 2.2835238165618614, 0.2: 2.6743263796785075, 0.25: 2.746032776017132, 0.3: 2.954695734711237, 0.4: 3.245969698140442, 0.5: 3.7095432341681613, 0.6: 3.716933790179475}
 MSEs_std: {0.01: 0.06839849192431399, 0.05: 0.09724590854548436, 0.1: 0.23783905150903267, 0.15: 0.05241464194994329, 0.2: 0.130636958856457, 0.25: 0.10556921153883209, 0.3: 0.1976657574667607, 0.4: 0.2678056112495187, 0.5: 0.3130283956195832, 0.6: 0.18709895562494833}
M: 0.4
 MSEs_mean: {0.01: 0.041423445267895015, 0.05: 0.3629920139844517, 0.1: 0.8185504282397321, 0.15: 1.1958263575371615, 0.2: 1.5332891947379785, 0.25: 1.7200368846642302, 0.3: 1.9581695202250315, 0.4: 2.3263259816239588, 0.5: 2.497173105049812, 0.6: 2.6911120660936296}
 MSEs_std: {0.01: 0.002890082070746284, 0.05: 0.03307556389084374, 0.1: 0.08106858203195086, 0.15: 0.0332740206083904, 0.2: 0.04927750679748773, 0.25: 0.11012765891969287, 0.3: 0.10168790285088596, 0.4: 0.14990940988601054, 0.5: 0.20032633157126917, 0.6: 0.19635936926654585}
M: 0.6
 MSEs_mean: {0.01: 0.01085077045469874, 0.05: 0.15504130959069967, 0.1: 0.3564952112622338, 0.15: 0.5883410198115835, 0.2: 0.7922273972427735, 0.25: 0.9912458741250314, 0.3: 1.1954374557796172, 0.4: 1.4323730633415228, 0.5: 1.7047841502612695, 0.6: 1.8382814876869638}
 MSEs_std: {0.01: 0.000984949681119398, 0.05: 0.005066687934050591, 0.1: 0.019475887165869378, 0.15: 0.04333908721256846, 0.2: 0.08308766621051139, 0.25: 0.06289503812966844, 0.3: 0.07755643323814157, 0.4: 0.09609136596525854, 0.5: 0.09052504969924575, 0.6: 0.04008869666141945}
```
![mocha result](https://github.com/Dorothy594/Primal-Dual-Techniques-for-Distributed-Multitask-Learning/blob/main/FederatedLearning/self%20try%20result/two%20cluster%20result/mocha.png)


## 3D Road Experiment
```
algorithm 1, norm1: 
 mean train MSE: 0.022722663585793744 
 mean test MSE: 31.54527149820902
algorithm 1, norm2: 
 mean train MSE: 0.02313966654286622 
 mean test MSE: 41.9580812815937
algorithm 1, mocha: 
 mean train MSE: 1.9674535033693834e-05 
 mean test MSE: 21.13057872794887
federated learning: 
 mean train MSE: 342.9193792495025 
 mean test MSE: 400.7684097489003
linear regression: 
 mean train MSE: 257.2173898830977 
 mean test MSE: 303.6561945702476
decision tree: 
 mean train MSE: 146.19281791295796 
 mean test MSE: 188.06729166806068
```
![3d road experiment error bars plot](https://github.com/Dorothy594/Primal-Dual-Techniques-for-Distributed-Multitask-Learning/blob/main/FederatedLearning/self%20try%20result/3D%20Road%20Bar.png)

